<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Claymorphism 3D æŠ•è³‡çµ„åˆè©•ä¼° (æ‰‹æ©Ÿå…¨å¯¬ç‰ˆ)</title>
    <style>
        /* ****** é¡è‰²èˆ‡é™°å½±è®Šé‡ (Claymorphism ç²¾ç¢ºè¨­å®š) ****** */
        :root {
            --bg-color: #F2F6FF; 
            --main-color: #ffffff; 
            --input-bg: #EBEFF9; 
            --text-primary: #2d3748;
            --text-secondary: #718096;

            --shadow-light: 7px 7px 15px rgba(255, 255, 255, 0.9), -7px -7px 15px rgba(174, 190, 218, 0.4);
            --shadow-dark: 5px 5px 10px rgba(174, 190, 218, 0.5), -5px -5px 10px rgba(255, 255, 255, 1);
            --inner-shadow: inset 4px 4px 8px rgba(174, 190, 218, 0.6), inset -4px -4px 8px rgba(255, 255, 255, 0.8);
            
            --btn-calc-color: #FF8F4A; 
            --btn-calc-shadow: 0 10px 20px rgba(255, 143, 74, 0.5); 
            --active-color: #3867D6; 

            --success-color: #e9f8f4;
            --warning-color: #fef4f4;
            --info-color: #eff5ff;
            --action-color: #fff8e8;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-color); 
            display: flex;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            /* è®“å…§å®¹é ‚éƒ¨å°é½Šï¼Œè€Œä¸æ˜¯å±…ä¸­ */
            padding: 0; /* ç§»é™¤ body çš„ä¸Šä¸‹ padding */
            color: var(--text-primary);
        }

        /* ************************************************* */
        /* ****** ä¸»è¦ä¿®æ”¹éƒ¨åˆ†ï¼šå…¨å¯¬åº¦æ‰‹æ©Ÿé©é…èˆ‡å–æ¶ˆå¤–æ¡† ****** */
        /* ************************************************* */
        .container {
            background: var(--main-color);
            padding: 30px 25px; /* å…§é‚Šè·ä¿ç•™ï¼Œç¢ºä¿å…§å®¹ä¸æœƒç·Šè²¼é‚Šç·£ */
            border-radius: 0; /* å–æ¶ˆå¤–æ¡†åœ“è§’ */
            box-shadow: none; /* å–æ¶ˆå¤–æ¡†é™°å½± */
            width: 100%; /* å…¨å¯¬åº¦ */
            max-width: 100%; /* å–æ¶ˆæœ€å¤§å¯¬åº¦é™åˆ¶ */
            box-sizing: border-box;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        /* ************************************************* */
        
        h2 {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 30px;
            color: var(--text-primary);
        }
        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--text-secondary);
        }

        /* ------------------------------------- */
        /* è¼¸å…¥æ¡†é¢¨æ ¼ (å‡¹é™·è¨­è¨ˆ) */
        /* ------------------------------------- */
        input[type="number"], input[type="text"] {
            width: 100%;
            padding: 12px 15px;
            border: none;
            border-radius: 18px;
            font-size: 1rem;
            background-color: var(--input-bg); 
            box-sizing: border-box;
            outline: none;
            box-shadow: var(--inner-shadow);
            transition: all 0.3s ease; 
            color: var(--text-primary);
            margin-bottom: 20px; /* å¢åŠ é–“éš” */
        }
        input[type="number"]:focus, input[type="text"]:focus {
            background-color: #e3e8f4; 
            transform: scale(1.01); 
        }

        /* ------------------------------------- */
        /* æ¯”ä¾‹é¸æ“‡æŒ‰éˆ• (å‡¸èµ·/å‡¹é™·ç‹€æ…‹) */
        /* ------------------------------------- */
        .config-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr); 
            gap: 15px;
            margin-bottom: 25px;
        }
        .config-buttons button {
            padding: 14px 10px;
            border: none;
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease; 
            color: var(--text-primary);
            background: var(--main-color);
            box-shadow: var(--shadow-dark); 
        }
        .config-buttons button:hover:not(.active) {
            transform: translateY(-2px); 
            box-shadow: 7px 7px 15px rgba(174, 190, 218, 0.6), -7px -7px 15px rgba(255, 255, 255, 0.8);
        }
        /* æ¿€æ´»ç‹€æ…‹ï¼šæ·±è‰²å‡¹é™· */
        .config-buttons button.active {
            background-color: var(--active-color);
            color: white;
            box-shadow: inset 3px 3px 6px rgba(0, 0, 0, 0.2), inset -3px -3px 6px rgba(255, 255, 255, 0.2); 
            transform: scale(1.0);
        }
        
        /* ------------------------------------- */
        /* ä¸»è¦è¨ˆç®—æŒ‰éˆ• (ç³–æœæ©™ 3D è³ªæ„Ÿ) */
        /* ------------------------------------- */
        button#calculate-btn {
            width: 100%;
            padding: 18px;
            background-color: var(--btn-calc-color); 
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 1.2rem;
            font-weight: 800;
            cursor: pointer;
            margin-top: 25px;
            box-shadow: var(--btn-calc-shadow); 
            transition: all 0.2s ease;
            text-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
        }
        button#calculate-btn:hover {
            opacity: 0.95;
            box-shadow: 0 12px 25px rgba(255, 143, 74, 0.7); 
        }
        button#calculate-btn:active {
            box-shadow: 0 3px 10px rgba(255, 143, 74, 0.6); 
            transform: translateY(3px); 
        }

        /* ------------------------------------- */
        /* çµæœå±•ç¤º (å‹•ç•«å®šç¾©) */
        /* ------------------------------------- */
        @keyframes fadeInSlide {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .result-panel {
            margin-top: 35px;
            padding-top: 20px;
            border-top: 1px solid rgba(174, 190, 218, 0.3);
            display: none; 
            animation: fadeInSlide 0.6s ease-out forwards; 
        }
        
        /* ç‹€æ…‹/å»ºè­°å¡ç‰‡é¢¨æ ¼ (ä¿æŒéæ¸¡) */
        .status-box, .action-steps, .dca-advice {
            transition: box-shadow 0.3s ease;
            border: none;
            border-radius: 20px;
            margin-top: 15px;
            padding: 20px;
            font-weight: 600;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05); 
        }

        /* ------------------------------------- */
        /* å…¶é¤˜éœæ…‹æ¨£å¼ä¿æŒä¸è®Š */
        /* ------------------------------------- */

        .summary-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 25px;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 3px 3px 8px rgba(174, 190, 218, 0.4); 
        }
        .summary-table th, .summary-table td {
            text-align: left;
            padding: 15px;
            font-size: 0.95rem;
            background-color: var(--main-color);
            border-bottom: 1px solid var(--input-bg);
        }
        .summary-table th {
            background-color: var(--input-bg);
            color: var(--text-primary);
        }
        .status-ok { background-color: var(--success-color); color: #38a169; }
        .status-warn { background-color: var(--warning-color); color: #e53e3e; }
        .action-steps { background-color: var(--info-color); color: var(--active-color); }
        .dca-advice { background-color: var(--action-color); color: #dd6b20; }
        
        /* æ‰‹æ©Ÿä¸Šå…©æ¬„è¼¸å…¥ä¿æŒ */
        .asset-config-row { display: flex; gap: 15px; }
        .asset-config-row > div { flex: 1; }
        
        /* é‡å° label èˆ‡ input çš„é–“è·èª¿æ•´ */
        .input-group { margin-bottom: 5px; } 

        .note { font-size: 0.8rem; color: var(--text-secondary); margin-top: 30px; text-align: center; }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ¯ Claymorphism æŠ•è³‡çµ„åˆ</h2>
    
    <div class="input-group">
        <label>è¨­å®šç›®æ¨™æ¯”ä¾‹ (Asset A / Asset B)</label>
        <div class="config-buttons">
            <button id="btn-80-20" class="active" onclick="setTarget(80, 20)">80% / 20%</button>
            <button id="btn-70-30" onclick="setTarget(70, 30)">70% / 30%</button>
            <button id="btn-60-40" onclick="setTarget(60, 40)">60% / 40%</button>
            <button id="btn-50-50" onclick="setTarget(50, 50)">50% / 50%</button>
        </div>
    </div>

    <div class="asset-config-row">
        <div class="input-group">
            <label for="assetAName">æ ¸å¿ƒè³‡ç”¢ (Asset A):</label>
            <input type="text" id="assetAName" value="QQQ" placeholder="ä¾‹å¦‚: VOO, QQQ">
        </div>
        <div class="input-group">
            <label for="assetBName">è¡›æ˜Ÿè³‡ç”¢ (Asset B):</label>
            <input type="text" id="assetBName" placeholder="è«‹è¼¸å…¥ (ä¾‹å¦‚: BND, JEPI)">
        </div>
    </div>

    <div class="input-group">
        <label for="tolerance">å®¹å¿åº¦ (%)</label>
        <input type="number" id="tolerance" value="5" placeholder="ä¾‹å¦‚: 5 (ä»£è¡¨ Â±5%)">
    </div>

    <div class="asset-config-row">
        <div class="input-group">
            <label id="assetALabel" for="qqqVal">QQQ ç•¶å‰å¸‚å€¼ (K$)</label>
            <input type="number" id="qqqVal" placeholder="ä¾‹å¦‚: 8.50">
        </div>
        <div class="input-group">
            <label id="assetBLabel" for="jepiVal">è«‹è¼¸å…¥ ç•¶å‰å¸‚å€¼ (K$)</label>
            <input type="number" id="jepiVal" placeholder="ä¾‹å¦‚: 1.50">
        </div>
    </div>
    
    <div class="input-group">
        <label for="dcaAmount">æ¯æœˆä¾›æ¬¾é‡‘é¡ (K$)</label>
        <input type="number" id="dcaAmount" placeholder="ä¾‹å¦‚: 0.50 (å³ $500)">
    </div>

    <button id="calculate-btn" onclick="calculate()">åŸ·è¡Œè¨ˆç®—èˆ‡è©•ä¼°</button>

    <div id="resultPanel" class="result-panel">
        <h3 style="font-size: 1.3rem; margin-top: 0; color: var(--text-primary);">ğŸ“Š çµ„åˆç‹€æ³æ¦‚è¦</h3>

        <table class="summary-table">
            <thead>
                <tr>
                    <th>è³‡ç”¢</th>
                    <th>å¸‚å€¼ (K$)</th>
                    <th>æ¯”ä¾‹</th>
                    <th>ç›®æ¨™</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td id="resAssetNameA">QQQ</td>
                    <td id="resQQQVal" class="highlight">-</td>
                    <td id="resQQQPct">-</td>
                    <td id="resTargetA">80% (Â±5%)</td>
                </tr>
                <tr>
                    <td id="resAssetNameB">è«‹è¼¸å…¥</td>
                    <td id="resJEPIVal" class="highlight">-</td>
                    <td id="resJEPIPct">-</td>
                    <td id="resTargetB">20% (Â±5%)</td>
                </tr>
                <tr>
                    <td class="highlight">ç¸½è³‡ç”¢</td>
                    <td id="resTotal" class="highlight" colspan="3">-</td>
                </tr>
            </tbody>
        </table>

        <div id="statusBox" class="status-box"></div>
        <div id="dcaAdvice" class="dca-advice"></div>
        <div id="actionSteps" class="action-steps" style="display:none;"></div>
    </div>
    
    <div class="note">æ‰€æœ‰é‡‘é¡ä»¥ K$ (åƒç¾å…ƒ) è¨ˆç®—ã€‚</div>
</div>

<script>
    // JS Logic (ä¿æŒä¸è®Š)
    let targetA_pct = 80;
    let targetB_pct = 20;

    function setTarget(A, B) {
        targetA_pct = A;
        targetB_pct = B;
        
        document.getElementById('btn-80-20').classList.toggle('active', A === 80);
        document.getElementById('btn-70-30').classList.toggle('active', A === 70);
        document.getElementById('btn-60-40').classList.toggle('active', A === 60);
        document.getElementById('btn-50-50').classList.toggle('active', A === 50);

        const tolerance = parseFloat(document.getElementById('tolerance').value) || 5;
        document.getElementById('resTargetA').innerText = `${targetA_pct}% (Â±${tolerance}%)`;
        document.getElementById('resTargetB').innerText = `${targetB_pct}% (Â±${tolerance}%)`;
    }
    
    document.addEventListener('DOMContentLoaded', () => {
        setTarget(80, 20);
    });

    function calculate() {
        const assetAName = document.getElementById('assetAName').value.toUpperCase().trim() || 'Asset A';
        const assetBName = document.getElementById('assetBName').value.toUpperCase().trim() || 'Asset B';
        const tolerance = parseFloat(document.getElementById('tolerance').value) || 5;
        
        const qqqVal = parseFloat(document.getElementById('qqqVal').value) || 0;
        const jepiVal = parseFloat(document.getElementById('jepiVal').value) || 0;
        const dcaAmount = parseFloat(document.getElementById('dcaAmount').value) || 0;
        
        const totalVal = qqqVal + jepiVal;

        if (totalVal <= 0) {
            alert("ç¸½è³‡ç”¢å¿…é ˆå¤§æ–¼ 0 æ‰èƒ½è¨ˆç®—æ¯”ä¾‹");
            return;
        }

        const minA = targetA_pct - tolerance;
        const maxA = targetA_pct + tolerance;
        
        document.getElementById('assetALabel').innerText = `${assetAName} ç•¶å‰å¸‚å€¼ (K$)`;
        document.getElementById('assetBLabel').innerText = `${assetBName} ç•¶å‰å¸‚å€¼ (K$)`;
        document.getElementById('resAssetNameA').innerText = assetAName;
        document.getElementById('resAssetNameB').innerText = assetBName;
        document.getElementById('resTargetA').innerText = `${targetA_pct}% (Â±${tolerance}%)`;
        document.getElementById('resTargetB').innerText = `${targetB_pct}% (Â±${tolerance}%)`;

        const assetAPct = (qqqVal / totalVal) * 100;
        
        document.getElementById('resQQQVal').innerText = `K$${qqqVal.toFixed(2)}`;
        document.getElementById('resQQQPct').innerText = `${assetAPct.toFixed(2)}%`;
        document.getElementById('resJEPIVal').innerText = `K$${jepiVal.toFixed(2)}`;
        document.getElementById('resJEPIPct').innerText = `${(100 - assetAPct).toFixed(2)}%`;
        document.getElementById('resTotal').innerText = `K$${totalVal.toFixed(2)}`;

        // ********** å‹•ç•«é‚è¼¯æ›´æ–° **********
        const resultPanel = document.getElementById('resultPanel');
        resultPanel.style.display = "none"; 
        void resultPanel.offsetWidth; 
        resultPanel.style.display = "block"; 
        // **********************************

        const statusBox = document.getElementById('statusBox');
        const actionSteps = document.getElementById('actionSteps');
        const dcaAdvice = document.getElementById('dcaAdvice');
        
        let needsRebalance = false;
        let message = "";
        
        if (assetAPct > maxA) {
            needsRebalance = true;
            message = `âš ï¸ ${assetAName} ä½”æ¯”éé«˜ (${assetAPct.toFixed(2)}% > ${maxA}%)ï¼Œå·²é”åˆ°è§¸ç™¼é»ã€‚`;
            statusBox.className = "status-box status-warn";
        } else if (assetAPct < minA) {
            needsRebalance = true;
            message = `âš ï¸ ${assetAName} ä½”æ¯”éä½ (${assetAPct.toFixed(2)}% < ${minA}%)ï¼Œå·²é”åˆ°è§¸ç™¼é»ã€‚`;
            statusBox.className = "status-box status-warn";
        } else {
            message = "âœ… æŠ•è³‡çµ„åˆæ¯”ä¾‹å¥åº·ï¼Œç„¡éœ€èª¿æ•´ç¾æœ‰å€‰ä½ã€‚";
            statusBox.className = "status-box status-ok";
        }
        
        statusBox.innerText = message;

        // --- å‚³çµ±å†å¹³è¡¡å»ºè­° ---
        if (needsRebalance) {
            actionSteps.style.display = "block";
            
            const targetA = totalVal * (targetA_pct / 100);
            const diffA = targetA - qqqVal; 
            const diffB = -diffA; 
            
            const buyColor = 'var(--active-color)'; 
            const sellColor = '#c53030'; 

            const assetAAct = diffA > 0 ? `<span style="color:${buyColor}">è²·å…¥ K$${Math.abs(diffA).toFixed(2)}</span>` : `<span style="color:${sellColor}">è³£å‡º K$${Math.abs(diffA).toFixed(2)}</span>`;
            const assetBAct = diffB > 0 ? `<span style="color:${buyColor}">è²·å…¥ K$${Math.abs(diffB).toFixed(2)}</span>` : `<span style="color:${sellColor}">è³£å‡º K$${Math.abs(diffB).toFixed(2)}</span>`;

            actionSteps.innerHTML = `
                <strong>ğŸ› ï¸ å‚³çµ±å†å¹³è¡¡å»ºè­° (å€‰ä½èª¿æ•´)ï¼š</strong><br>
                ç‚ºäº†é”åˆ° ${targetA_pct}/${targetB_pct} æ¯”ä¾‹ï¼Œæ‚¨éœ€è¦åŸ·è¡Œä»¥ä¸‹æ“ä½œï¼š<br>
                1. ${assetAName}: ${assetAAct}<br>
                2. ${assetBName}: ${assetBAct}
            `;
        } else {
            actionSteps.style.display = "none";
        }

        // --- æœˆä¾›åˆ†é…å»ºè­° ---
        let dcaMsg = "";

        if (dcaAmount > 0) {
            if (needsRebalance) {
                if (assetAPct > targetA_pct) {
                    dcaMsg = `
                        <strong>ğŸ”¥ æœˆä¾›å»ºè­° (ä¿®æ­£æ¨¡å¼)ï¼š</strong><br>
                        ç”±æ–¼ ${assetAName} åš´é‡è¶…é‡ï¼Œå»ºè­°å°‡ **100%** (${dcaAmount.toFixed(2)} K$) çš„æœˆä¾›å…¨éƒ¨æŠ•å…¥ï¼š
                        <br>â¡ï¸ **${assetBName}**
                        <br><small>ç›´è‡³æ•´é«”çµ„åˆæ¯”ä¾‹å›åˆ° ${targetA_pct}/${targetB_pct} ç¯„åœç‚ºæ­¢ã€‚</small>
                    `;
                } else if (assetAPct < targetA_pct) { 
                     dcaMsg = `
                        <strong>ğŸ”¥ æœˆä¾›å»ºè­° (ä¿®æ­£æ¨¡å¼)ï¼š</strong><br>
                        ç”±æ–¼ ${assetAName} åš´é‡ä¸è¶³ï¼Œå»ºè­°å°‡ **100%** (${dcaAmount.toFixed(2)} K$) çš„æœˆä¾›å…¨éƒ¨æŠ•å…¥ï¼š
                        <br>â¡ï¸ **${assetAName}**
                        <br><small>ç›´è‡³æ•´é«”çµ„åˆæ¯”ä¾‹å›åˆ° ${targetA_pct}/${targetB_pct} ç¯„åœç‚ºæ­¢ã€‚</small>
                    `;
                }
            } else {
                const dcaA = dcaAmount * (targetA_pct / 100);
                const dcaB = dcaAmount * (targetB_pct / 100);
                dcaMsg = `
                    <strong>ğŸ‘ æœˆä¾›å»ºè­° (æ­£å¸¸æ¨¡å¼)ï¼š</strong><br>
                    ç›®å‰çš„å€‰ä½æ¯”ä¾‹å¥åº·ï¼Œå»ºè­°æœˆä¾›æŒ‰ç›®æ¨™ ${targetA_pct}/${targetB_pct} æ¯”ä¾‹åˆ†é…ï¼š
                    <br>â¡ï¸ ${assetAName} ${targetA_pct}% (K$${dcaA.toFixed(2)})
                    <br>â¡ï¸ ${assetBName} ${targetB_pct}% (K$${dcaB.toFixed(2)})
                `;
            }
        } else {
            dcaMsg = "è«‹è¼¸å…¥ã€Œæ¯æœˆä¾›æ¬¾é‡‘é¡ (K$)ã€ä»¥ç²å–æœˆä¾›åˆ†é…å»ºè­°ã€‚";
        }

        dcaAdvice.innerHTML = dcaMsg;
    }
</script>

</body>
</html>